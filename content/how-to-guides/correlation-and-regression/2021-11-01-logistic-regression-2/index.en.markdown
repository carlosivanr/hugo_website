---
title: Logistic Regression Pt.2 - (Work in progress)
author: Carlos Rodriguez
date: '2021-11-01'
slug: logistic-regression-2
categories: []
tags: []
subtitle: ''
summary: ''
authors: []
lastmod: '2021-11-01T19:48:10-06:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
type: book
weight: 75
draft: true
---


```r
library(car)
library(kableExtra)
library(tidyverse)
```


### Load data

```r
#load data
eelData <- read.delim("../2021-10-17-logistic-regression/eel.dat", header = TRUE)
eelData$Cured <- factor(eelData$Cured, levels = c("Not Cured", "Cured"))
eelData$Intervention <- factor(eelData$Intervention, levels = c("No Treatment", "Intervention"))
```


### Model data

```r
eel_model.2 <- glm(Cured ~ Intervention + Duration, family = binomial(), data = eelData)

summary(eel_model.2)
```

```
## 
## Call:
## glm(formula = Cured ~ Intervention + Duration, family = binomial(), 
##     data = eelData)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.6025  -1.0572   0.8107   0.8161   1.3095  
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(>|z|)   
## (Intercept)              -0.234660   1.220563  -0.192  0.84754   
## InterventionIntervention  1.233532   0.414565   2.975  0.00293 **
## Duration                 -0.007835   0.175913  -0.045  0.96447   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 154.08  on 112  degrees of freedom
## Residual deviance: 144.16  on 110  degrees of freedom
## AIC: 150.16
## 
## Number of Fisher Scoring iterations: 4
```


```r
modelChi <- eel_model.1$deviance - eel_model.2$deviance
chidf <- eel_model.1$df.residual - eel_model.2$df.residual
chisq.prob <- 1 - pchisq(modelChi, chidf)
modelChi; chidf; chisq.prob
```

```
## [1] 0.001983528
```

```
## [1] 1
```

```
## [1] 0.9644765
```



```r
anova(eel_model.1, eel_model.2)
```

```
## Analysis of Deviance Table
## 
## Model 1: Cured ~ Intervention
## Model 2: Cured ~ Intervention + Duration
##   Resid. Df Resid. Dev Df  Deviance
## 1       111     144.16             
## 2       110     144.16  1 0.0019835
```

### Diagnostics

```r
#dx <- function(dataframe, model){
#   dataframe$predicted.probabilities <-fitted(model)
#   dataframe$standardized.residuals <- rstandard(model)
#   dataframe$studentized.residuals <- rstudent(model)
#   dataframe$dfbeta <- dfbeta(model)
#   dataframe$dffit <- dffits(model)
#   dataframe$leverage <- hatvalues(model)
# }
#dx(eelData, eel_model.1)


eelData$predicted.probabilities <- fitted(eel_model.1)
eelData$standardized.residuals <- rstandard(eel_model.1)
eelData$studentized.residuals <- rstudent(eel_model.1)
eelData$dfbeta <- dfbeta(eel_model.1)
eelData$dffit <- dffits(eel_model.1)
eelData$leverage <- hatvalues(eel_model.1)

head(eelData[, c("Cured", "Intervention", "Duration", "predicted.probabilities")])
```

```
##       Cured Intervention Duration predicted.probabilities
## 1 Not Cured No Treatment        7               0.4285714
## 2 Not Cured No Treatment        7               0.4285714
## 3 Not Cured No Treatment        6               0.4285714
## 4     Cured No Treatment        8               0.4285714
## 5     Cured Intervention        7               0.7192982
## 6     Cured No Treatment        6               0.4285714
```

```r
eelData[, c("leverage", "studentized.residuals", "dfbeta")]
```

```
##       leverage studentized.residuals dfbeta.(Intercept)
## 1   0.01785714            -1.0643627      -3.886912e-02
## 2   0.01785714            -1.0643627      -3.886912e-02
## 3   0.01785714            -1.0643627      -3.886912e-02
## 4   0.01785714             1.3110447       4.782751e-02
## 5   0.01754386             0.8160435       2.283164e-18
## 6   0.01785714             1.3110447       4.782751e-02
## 7   0.01754386            -1.6083171      -4.483364e-18
## 8   0.01754386             0.8160435       2.283164e-18
## 9   0.01785714             1.3110447       4.782751e-02
## 10  0.01785714            -1.0643627      -3.886912e-02
## 11  0.01754386             0.8160435       2.283164e-18
## 12  0.01785714             1.3110447       4.782751e-02
## 13  0.01785714             1.3110447       4.782751e-02
## 14  0.01754386            -1.6083171      -4.483364e-18
## 15  0.01785714            -1.0643627      -3.886912e-02
## 16  0.01785714            -1.0643627      -3.886912e-02
## 17  0.01754386             0.8160435       2.283164e-18
## 18  0.01754386            -1.6083171      -4.483364e-18
## 19  0.01754386             0.8160435       2.283164e-18
## 20  0.01754386             0.8160435       2.283164e-18
## 21  0.01785714            -1.0643627      -3.886912e-02
## 22  0.01754386             0.8160435       2.283164e-18
## 23  0.01754386             0.8160435       2.283164e-18
## 24  0.01785714            -1.0643627      -3.886912e-02
## 25  0.01754386             0.8160435       2.283164e-18
## 26  0.01754386             0.8160435       2.283164e-18
## 27  0.01785714             1.3110447       4.782751e-02
## 28  0.01785714             1.3110447       4.782751e-02
## 29  0.01754386             0.8160435       2.283164e-18
## 30  0.01754386             0.8160435       2.283164e-18
## 31  0.01785714            -1.0643627      -3.886912e-02
## 32  0.01785714             1.3110447       4.782751e-02
## 33  0.01754386             0.8160435       2.283164e-18
## 34  0.01754386            -1.6083171      -4.483364e-18
## 35  0.01754386             0.8160435       2.283164e-18
## 36  0.01785714             1.3110447       4.782751e-02
## 37  0.01785714             1.3110447       4.782751e-02
## 38  0.01754386            -1.6083171      -4.483364e-18
## 39  0.01785714             1.3110447       4.782751e-02
## 40  0.01754386             0.8160435       2.283164e-18
## 41  0.01785714             1.3110447       4.782751e-02
## 42  0.01754386            -1.6083171      -4.483364e-18
## 43  0.01754386             0.8160435       2.283164e-18
## 44  0.01754386            -1.6083171      -4.483364e-18
## 45  0.01785714            -1.0643627      -3.886912e-02
## 46  0.01785714            -1.0643627      -3.886912e-02
## 47  0.01785714            -1.0643627      -3.886912e-02
## 48  0.01754386            -1.6083171      -4.483364e-18
## 49  0.01754386            -1.6083171      -4.483364e-18
## 50  0.01785714             1.3110447       4.782751e-02
## 51  0.01754386             0.8160435       2.283164e-18
## 52  0.01754386             0.8160435       2.283164e-18
## 53  0.01754386             0.8160435       2.283164e-18
## 54  0.01785714             1.3110447       4.782751e-02
## 55  0.01785714            -1.0643627      -3.886912e-02
## 56  0.01754386             0.8160435       2.283164e-18
## 57  0.01754386             0.8160435       2.283164e-18
## 58  0.01785714            -1.0643627      -3.886912e-02
## 59  0.01754386             0.8160435       2.283164e-18
## 60  0.01754386             0.8160435       2.283164e-18
## 61  0.01785714             1.3110447       4.782751e-02
## 62  0.01785714            -1.0643627      -3.886912e-02
## 63  0.01785714             1.3110447       4.782751e-02
## 64  0.01754386            -1.6083171      -4.483364e-18
## 65  0.01754386             0.8160435       2.283164e-18
## 66  0.01785714            -1.0643627      -3.886912e-02
## 67  0.01785714            -1.0643627      -3.886912e-02
## 68  0.01785714             1.3110447       4.782751e-02
## 69  0.01785714            -1.0643627      -3.886912e-02
## 70  0.01785714            -1.0643627      -3.886912e-02
## 71  0.01754386             0.8160435       2.283164e-18
## 72  0.01785714            -1.0643627      -3.886912e-02
## 73  0.01754386            -1.6083171      -4.483364e-18
## 74  0.01754386             0.8160435       2.283164e-18
## 75  0.01754386             0.8160435       2.283164e-18
## 76  0.01785714             1.3110447       4.782751e-02
## 77  0.01754386             0.8160435       2.283164e-18
## 78  0.01754386            -1.6083171      -4.483364e-18
## 79  0.01785714             1.3110447       4.782751e-02
## 80  0.01754386            -1.6083171      -4.483364e-18
## 81  0.01785714             1.3110447       4.782751e-02
## 82  0.01785714            -1.0643627      -3.886912e-02
## 83  0.01754386             0.8160435       2.283164e-18
## 84  0.01754386             0.8160435       2.283164e-18
## 85  0.01754386            -1.6083171      -4.483364e-18
## 86  0.01754386             0.8160435       2.283164e-18
## 87  0.01785714             1.3110447       4.782751e-02
## 88  0.01754386            -1.6083171      -4.483364e-18
## 89  0.01754386             0.8160435       2.283164e-18
## 90  0.01785714            -1.0643627      -3.886912e-02
## 91  0.01754386             0.8160435       2.283164e-18
## 92  0.01785714            -1.0643627      -3.886912e-02
## 93  0.01754386             0.8160435       2.283164e-18
## 94  0.01754386             0.8160435       2.283164e-18
## 95  0.01754386            -1.6083171      -4.483364e-18
## 96  0.01754386             0.8160435       2.283164e-18
## 97  0.01785714             1.3110447       4.782751e-02
## 98  0.01785714            -1.0643627      -3.886912e-02
## 99  0.01785714            -1.0643627      -3.886912e-02
## 100 0.01754386             0.8160435       2.283164e-18
## 101 0.01785714            -1.0643627      -3.886912e-02
## 102 0.01785714            -1.0643627      -3.886912e-02
## 103 0.01754386             0.8160435       2.283164e-18
## 104 0.01785714             1.3110447       4.782751e-02
## 105 0.01785714            -1.0643627      -3.886912e-02
## 106 0.01785714             1.3110447       4.782751e-02
## 107 0.01785714            -1.0643627      -3.886912e-02
## 108 0.01785714            -1.0643627      -3.886912e-02
## 109 0.01754386             0.8160435       2.283164e-18
## 110 0.01754386             0.8160435       2.283164e-18
## 111 0.01785714            -1.0643627      -3.886912e-02
## 112 0.01785714            -1.0643627      -3.886912e-02
## 113 0.01754386             0.8160435       2.283164e-18
##     dfbeta.InterventionIntervention
## 1                      3.886912e-02
## 2                      3.886912e-02
## 3                      3.886912e-02
## 4                     -4.782751e-02
## 5                      3.225994e-02
## 6                     -4.782751e-02
## 7                     -6.334765e-02
## 8                      3.225994e-02
## 9                     -4.782751e-02
## 10                     3.886912e-02
## 11                     3.225994e-02
## 12                    -4.782751e-02
## 13                    -4.782751e-02
## 14                    -6.334765e-02
## 15                     3.886912e-02
## 16                     3.886912e-02
## 17                     3.225994e-02
## 18                    -6.334765e-02
## 19                     3.225994e-02
## 20                     3.225994e-02
## 21                     3.886912e-02
## 22                     3.225994e-02
## 23                     3.225994e-02
## 24                     3.886912e-02
## 25                     3.225994e-02
## 26                     3.225994e-02
## 27                    -4.782751e-02
## 28                    -4.782751e-02
## 29                     3.225994e-02
## 30                     3.225994e-02
## 31                     3.886912e-02
## 32                    -4.782751e-02
## 33                     3.225994e-02
## 34                    -6.334765e-02
## 35                     3.225994e-02
## 36                    -4.782751e-02
## 37                    -4.782751e-02
## 38                    -6.334765e-02
## 39                    -4.782751e-02
## 40                     3.225994e-02
## 41                    -4.782751e-02
## 42                    -6.334765e-02
## 43                     3.225994e-02
## 44                    -6.334765e-02
## 45                     3.886912e-02
## 46                     3.886912e-02
## 47                     3.886912e-02
## 48                    -6.334765e-02
## 49                    -6.334765e-02
## 50                    -4.782751e-02
## 51                     3.225994e-02
## 52                     3.225994e-02
## 53                     3.225994e-02
## 54                    -4.782751e-02
## 55                     3.886912e-02
## 56                     3.225994e-02
## 57                     3.225994e-02
## 58                     3.886912e-02
## 59                     3.225994e-02
## 60                     3.225994e-02
## 61                    -4.782751e-02
## 62                     3.886912e-02
## 63                    -4.782751e-02
## 64                    -6.334765e-02
## 65                     3.225994e-02
## 66                     3.886912e-02
## 67                     3.886912e-02
## 68                    -4.782751e-02
## 69                     3.886912e-02
## 70                     3.886912e-02
## 71                     3.225994e-02
## 72                     3.886912e-02
## 73                    -6.334765e-02
## 74                     3.225994e-02
## 75                     3.225994e-02
## 76                    -4.782751e-02
## 77                     3.225994e-02
## 78                    -6.334765e-02
## 79                    -4.782751e-02
## 80                    -6.334765e-02
## 81                    -4.782751e-02
## 82                     3.886912e-02
## 83                     3.225994e-02
## 84                     3.225994e-02
## 85                    -6.334765e-02
## 86                     3.225994e-02
## 87                    -4.782751e-02
## 88                    -6.334765e-02
## 89                     3.225994e-02
## 90                     3.886912e-02
## 91                     3.225994e-02
## 92                     3.886912e-02
## 93                     3.225994e-02
## 94                     3.225994e-02
## 95                    -6.334765e-02
## 96                     3.225994e-02
## 97                    -4.782751e-02
## 98                     3.886912e-02
## 99                     3.886912e-02
## 100                    3.225994e-02
## 101                    3.886912e-02
## 102                    3.886912e-02
## 103                    3.225994e-02
## 104                   -4.782751e-02
## 105                    3.886912e-02
## 106                   -4.782751e-02
## 107                    3.886912e-02
## 108                    3.886912e-02
## 109                    3.225994e-02
## 110                    3.225994e-02
## 111                    3.886912e-02
## 112                    3.886912e-02
## 113                    3.225994e-02
```
